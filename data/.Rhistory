data.d
data.d <- data[[1]]
data.d
data.d[complete.cases(data.d),]
data.d <- data.d[complete.cases(data.d),]
data.d
filter(data.d, Year == c(index_year-2, index_year-1, index_year))
filter(data.d, Year == paste(index_year) | Year == paste(index_year-1) | Year == paste(index_year-2))
filter(data.d, Year == c(index_year-2, index_year-1, index_year))
filter(data.d, Year == paste(index_year) | Year == paste(index_year-1) | Year == paste(index_year-2))
paste(v)
stats <- filter(data.d, Year == paste(index_year) |
Year == paste(index_year-1) |
Year == paste(index_year-2))
stats <- filter(data.d, Year == paste(index_year) |
Year == paste(index_year-1) |
Year == paste(index_year-2))
data.d <- data[complete.cases(data[[1]]),]
data.d <- data[complete.cases(data[1]),]
data.d <- data[[complete.cases(data[[1]]),]]
data.d <- data.d[complete.cases(data.d),]
index_year <- tjs %>%
## this will be key_mlbam == i
filter(key_mlbam == 425856) %>%
select(index_year[[1]])
stats <- filter(data.d, Year == paste(index_year) |
Year == paste(index_year-1) |
Year == paste(index_year-2))
stats
pfx$mph <- filter(data.d, Year == paste(index_year) |
Year == paste(index_year-1) |
Year == paste(index_year-2))
pfx <- data.frame()
pfx$mph <- filter(data.d, Year == paste(index_year) |
Year == paste(index_year-1) |
Year == paste(index_year-2))
paste(v)
assign(paste(v), filter(data.d, Year == paste(i)))
View(mph)
View(mph)
head(mph)
head(mph$Year)
assign(paste(v), filter(data.d, Year == paste(index_year) |
Year == paste(index_year-1) |
Year == paste(index_year-2)))
head(mph)
mph
install.packages("tidyr")
library(tidyr)
mph %>%
gather((Year))
names(mph)
mph %>%
gather(($Year))
mph %>%
gather((mph$Year))
mph %>%
gather(("Year"))
class(mph)
mph
mph %>%
gather((year, pitch_type, speed))
mph %>%
gather(year, pitch_type, speed)
mph %>%
gather(year, pitch_type)
mph
mph %>%
gather(pitch_type)
mph
gather(year, pitch_type, -year)
mph %>%
gather(year, pitch_type, -year)
mph %>%
gather(year, pitch_type, -Year)
filter(data.d, Year == paste(index_year) |
Year == paste(index_year-1) |
Year == paste(index_year-2)) %>%
gather(year, pitch_type, -Year)
str(mph)
tjs %>%
filter(key_mlbam == i) %>%
select(index_year[[1]]) %>%
filter(data.d, Year == paste(.) |
Year == paste(index_year-1) |
Year == paste(index_year-2)) %>%
gather(year, pitch_type, -Year)
filter(data.d, Year == paste(index_year) |
Year == paste(index_year-1) |
Year == paste(index_year-2)) %>%
gather(year, pitch_type, -Year)
assign(paste(v), filter(data.d, Year == paste(index_year) |
Year == paste(index_year-1) |
Year == paste(index_year-2)))
mpg %>%
gather(year, pitch_type, -Year)
mph %>%
gather(year, pitch_type, -Year)
mph
View(mph)
View(mph)
mph %>%
gather(pitch_type, speed)
mph %>%
gather(pitch_type, speed, -Year)
data <- readHTMLTable("http://www.brooksbaseball.net/velo.php?player=425856&b_hand=-1&gFilt=&pFilt=FA|SI|FC|CU|SL|CS|KN|CH|FS|SB&time=year&minmax=ci&var=mph&s_type=2&startDate=01/01/2008&endDate=12/31/2014", header = TRUE, skip.rows = 1, as.data.frame = TRUE, stringsAsFactors = FALSE)
data.d <- data[[1]]
data.d <- data.d[complete.cases(data.d),]
i = 425856
v = "mph"
index_year <- tjs %>%
filter(key_mlbam == i) %>%
select(index_year[[1]])
assign(paste(v), filter(data.d, Year == paste(index_year) |
)
assign(paste(v), filter(data.d, Year == paste(index_year) |
Year == paste(index_year-1) |
Year == paste(index_year-2)))
mph %>%
gather(pitch_type, speed, -Year)
filter(data.d, Year == paste(index_year) |
Year == paste(index_year-1) |
Year == paste(index_year-2)) %>%
gather(pitch_type, speed, -Year)
stats <- filter(data.d, Year == paste(index_year) |
Year == paste(index_year-1) |
Year == paste(index_year-2)) %>%
gather(pitchType, speed, -Year)
stats
stats$pfx_var <- rep(v, nrow(stats))
stats
stats$mlbam_id <- rep(i, nrow(stats))
stats
pitchfx <- data.frame()
rbind(pitchfx, stats)
pitchfx
pitchfx <- rbind(pitchfx, stats)
pitchfx
pitchfx <- rbind(pitchfx, stats)
pitchfx
rename(stats, "Year"="year")
rename(stats, Year="year")
rename(stats, c("Year"="year")
)
names(stats)
rename(stats, Year = year)
rename(stats, year = Year)
stats <- filter(data.d, Year == paste(index_year) |
Year == paste(index_year-1) |
Year == paste(index_year-2)) %>%
gather(pitchType, speed, -Year) %>%
rename(year = Year)
stats
stats$pfx_var <- rep(v, nrow(stats))
stats$mlbam_id <- rep(i, nrow(stats))
stats
pitchfx
pitchfx <- rbind(pitchfx, stats)
pitchfx
library(tidyr)
library(dplyr)
library(magrittr)
pitchers <- read.csv("tjs_pitchers.csv")
pitchers.keys <- pitchers$key_mlbam
var_list <-("mph", "maxmph", "pfx_x", "pfx_z", "hloc", "vloc", "bway")
pitchfx <- data.frame()
var_list <- c("mph", "maxmph", "pfx_x", "pfx_z", "hloc", "vloc", "bway")
i = 425856
v = "mph"
data <- function(i,v) {
url <- paste0("http://www.brooksbaseball.net/velo.php?
player=",i,"&b_hand=-1&gFilt=&pFilt=FA|SI|FC|CU|SL|CS|KN|CH|FS|SB&time=year&minmax=ci&
var=",v,"&s_type=2&startDate=01/01/2008&endDate=12/31/2014")
d <- readHTMLTable(url, header = TRUE, skip.rows = 1, as.data.frame = TRUE, stringsAsFactors = FALSE)
d <- d[[1]]
d <- d[complete.cases(data.d),]
d
}
data
data()
data()
data <- function(i,v) {
url <- paste0("http://www.brooksbaseball.net/velo.php?player=",i,"&b_hand=-1&gFilt=&pFilt=FA|SI|FC|CU|SL|CS|KN|CH|FS|SB&time=year&minmax=ci&var=",v,"&s_type=2&startDate=01/01/2008&endDate=12/31/2014")
d <- readHTMLTable(url, header = TRUE, skip.rows = 1, as.data.frame = TRUE, stringsAsFactors = FALSE)
d <- d[[1]]
d <- d[complete.cases(data.d),]
d
}
data()
data(i,v)
data(i,v)
data <- function(i,v) {
url <- paste0("http://www.brooksbaseball.net/velo.php?player=",i,"&b_hand=-1&gFilt=&pFilt=FA|SI|FC|CU|SL|CS|KN|CH|FS|SB&time=year&minmax=ci&var=",v,"&s_type=2&startDate=01/01/2008&endDate=12/31/2014")
d <- readHTMLTable(url, header = TRUE, skip.rows = 1, as.data.frame = TRUE, stringsAsFactors = FALSE)
d <- d[[1]]
d <- d[complete.cases(d),]
d
}
data(i,v)
data
stats <- function(i,v) {
index_year <- tjs %>%
filter(key_mlbam == i) %>%
select(index_year[[1]])
s <- data(i,v) %>%
filter(data, Year == paste(index_year) |
Year == paste(index_year-1) |
Year == paste(index_year-2)) %>%
gather(pitchType, speed, -Year) %>%
rename(year = Year)
}
stats
stats(i,v)
stats <- function(i,v) {
index_year <- pitchers %>%
filter(key_mlbam == i) %>%
select(index_year[[1]])
s <- data(i,v) %>%
filter(data, Year == paste(index_year) |
Year == paste(index_year-1) |
Year == paste(index_year-2)) %>%
gather(pitchType, speed, -Year) %>%
rename(year = Year)
}
stats(i,v)
stats <- function(i,v) {
index_year <- pitchers %>%
filter(key_mlbam == i) %>%
select(index_year[[1]])
s <- data(i,v) %>%
filter(Year == paste(index_year) |
Year == paste(index_year-1) |
Year == paste(index_year-2)) %>%
gather(pitchType, speed, -Year) %>%
rename(year = Year)
}
stats(i,v)
stats <- function(i,v) {
index_year <- pitchers %>%
filter(key_mlbam == i) %>%
select(index_year[[1]])
s <- data(i,v) %>%
filter(Year == paste(index_year) |
Year == paste(index_year-1) |
Year == paste(index_year-2)) %>%
gather(pitchType, speed, -Year) %>%
rename(year = Year)
s
}
stats(i,v)
stats$pfx_var <- rep(v, nrow(stats))
stats <- function(i,v) {
index_year <- pitchers %>%
filter(key_mlbam == i) %>%
select(index_year[[1]])
s <- data(i,v) %>%
filter(Year == paste(index_year) |
Year == paste(index_year-1) |
Year == paste(index_year-2)) %>%
gather(pitchType, speed, -Year) %>%
rename(year = Year)
s$pfx_var <- rep(v, nrow(stats))
s$mlbam_id <- rep(i, nrow(stats))
s
}
stats(i,v)
stats <- function(i,v) {
index_year <- pitchers %>%
filter(key_mlbam == i) %>%
select(index_year[[1]])
s <- data(i,v) %>%
filter(Year == paste(index_year) |
Year == paste(index_year-1) |
Year == paste(index_year-2)) %>%
gather(pitchType, speed, -Year) %>%
rename(year = Year)
s$pfx_var <- rep(v, nrow(s))
s$mlbam_id <- rep(i, nrow(s))
s
}
stats(i,v)
pitchfx
pitchfx <- stats(i,v) %>%
rbind(pitchfx)
pitchfx
head(tjs)
head(pitchers)
pitchfx <- stats(i,v) %>%
rbind(pitchfx)
pitchfx
i = 605228
pitchfx <- stats(i,v) %>%
rbind(pitchfx)
pitchfx
head(pitchers)
tail(pitchers)
library(tidyr)
library(dplyr)
library(magrittr)
pitchers <- read.csv("tjs_pitchers.csv")
pitchers.keys <- c(592238, 595032, 458537)
# pitchers.keys <- pitchers$key_mlbam
# var_list <- c("mph", "maxmph", "pfx_x", "pfx_z", "hloc", "vloc", "bway")
var_list <- c("mph")
pitchfx <- data.frame()
# for each pitcher
for i in length(pitchers.keys) {
# for each pitchf/x variable
for v in length(var_list) {
# TODO: move script into loop
# data table is returned as a list
# TODO: insert pitchers.keys[i] and var_list[v] into url
data <- function(i,v) {
url <- paste0("http://www.brooksbaseball.net/velo.php?player=",i,"&b_hand=-1&gFilt=&pFilt=FA|SI|FC|CU|SL|CS|KN|CH|FS|SB&time=year&minmax=ci&var=",v,"&s_type=2&startDate=01/01/2008&endDate=12/31/2014")
d <- readHTMLTable(url, header = TRUE, skip.rows = 1, as.data.frame = TRUE, stringsAsFactors = FALSE)
d <- d[[1]]
d <- d[complete.cases(d),]
d
}
stats <- function(i,v) {
index_year <- pitchers %>%
filter(key_mlbam == i) %>%
select(index_year[[1]])
s <- data(i,v) %>%
filter(Year == paste(index_year) |
Year == paste(index_year-1) |
Year == paste(index_year-2)) %>%
gather(pitchType, speed, -Year) %>%
rename(year = Year)
s$pfx_var <- rep(v, nrow(s))
s$mlbam_id <- rep(i, nrow(s))
s
}
pitchfx <- stats(i,v) %>%
rbind(pitchfx)
}
}
for i in length(pitchers.keys) {
# for each pitchf/x variable
for v in length(var_list) {
# TODO: move script into loop
# data table is returned as a list
# TODO: insert pitchers.keys[i] and var_list[v] into url
data <- function(i,v) {
url <- paste0("http://www.brooksbaseball.net/velo.php?player=",i,"&b_hand=-1&gFilt=&pFilt=FA|SI|FC|CU|SL|CS|KN|CH|FS|SB&time=year&minmax=ci&var=",v,"&s_type=2&startDate=01/01/2008&endDate=12/31/2014")
d <- readHTMLTable(url, header = TRUE, skip.rows = 1, as.data.frame = TRUE, stringsAsFactors = FALSE)
d <- d[[1]]
d <- d[complete.cases(d),]
d
}
stats <- function(i,v) {
index_year <- pitchers %>%
filter(key_mlbam == paste(i) %>%
select(index_year[[1]])
s <- data(i,v) %>%
filter(Year == paste(index_year) |
Year == paste(index_year-1) |
Year == paste(index_year-2)) %>%
gather(pitchType, speed, -Year) %>%
rename(year = Year)
s$pfx_var <- rep(v, nrow(s))
s$mlbam_id <- rep(i, nrow(s))
s
}
pitchfx <- stats(i,v) %>%
rbind(pitchfx)
}
}
# for each pitcher
for (i in length(pitchers.keys)) {
# for each pitchf/x variable
for (v in length(var_list)) {
# TODO: move script into loop
# data table is returned as a list
# TODO: insert pitchers.keys[i] and var_list[v] into url
data <- function(i,v) {
url <- paste0("http://www.brooksbaseball.net/velo.php?player=",i,"&b_hand=-1&gFilt=&pFilt=FA|SI|FC|CU|SL|CS|KN|CH|FS|SB&time=year&minmax=ci&var=",v,"&s_type=2&startDate=01/01/2008&endDate=12/31/2014")
d <- readHTMLTable(url, header = TRUE, skip.rows = 1, as.data.frame = TRUE, stringsAsFactors = FALSE)
d <- d[[1]]
d <- d[complete.cases(d),]
d
}
stats <- function(i,v) {
index_year <- pitchers %>%
filter(key_mlbam == paste(i) %>%
select(index_year[[1]])
s <- data(i,v) %>%
filter(Year == paste(index_year) |
Year == paste(index_year-1) |
Year == paste(index_year-2)) %>%
gather(pitchType, speed, -Year) %>%
rename(year = Year)
s$pfx_var <- rep(v, nrow(s))
s$mlbam_id <- rep(i, nrow(s))
s
}
pitchfx <- stats(i,v) %>%
rbind(pitchfx)
}
}
index_year <- pitchers %>%
filter(key_mlbam == paste(i)
)
i = 592238
index_year <- pitchers %>%
filter(key_mlbam == paste(i)
)
index_year
index_year <- pitchers %>%
filter(key_mlbam == paste(i) %>%
select(index_year[[1]])
)
index_year <- pitchers %>%
filter(key_mlbam == paste(i) %>%
select(index_year)
)
data <- function(i,v) {
url <- paste0("http://www.brooksbaseball.net/velo.php?player=",i,"&b_hand=-1&gFilt=&pFilt=FA|SI|FC|CU|SL|CS|KN|CH|FS|SB&time=year&minmax=ci&var=",v,"&s_type=2&startDate=01/01/2008&endDate=12/31/2014")
d <- readHTMLTable(url, header = TRUE, skip.rows = 1, as.data.frame = TRUE, stringsAsFactors = FALSE)
d <- d[[1]]
d <- tbl_df(d[complete.cases(d),])
d
}
data <- function(i,v) {
url <- paste0("http://www.brooksbaseball.net/velo.php?player=",i,"&b_hand=-1&gFilt=&pFilt=FA|SI|FC|CU|SL|CS|KN|CH|FS|SB&time=year&minmax=ci&var=",v,"&s_type=2&startDate=01/01/2008&endDate=12/31/2014")
d <- readHTMLTable(url, header = TRUE, skip.rows = 1, as.data.frame = TRUE, stringsAsFactors = FALSE)
d <- d[[1]]
d <- d[complete.cases(d),]
d
}
pitchers <- tbl_df(read.csv("tjs_pitchers.csv"))
pitchers %>%
filter(key_mlbam == paste(i) %>%
select(index_year)
)
pitchers %>%
filter(key_mlbam == paste(i)) %>%
select(index_year)
s <- data(i,v) %>%
filter(Year == paste(index_year) |
Year == paste(index_year-1) |
Year == paste(index_year-2)) %>%
gather(pitchType, speed, -Year) %>%
rename(year = Year)
s$pfx_var <- rep(v, nrow(s))
s$mlbam_id <- rep(i, nrow(s))
s
v = "mph"
s <- data(i,v) %>%
filter(Year == paste(index_year) |
Year == paste(index_year-1) |
Year == paste(index_year-2)) %>%
gather(pitchType, speed, -Year) %>%
rename(year = Year)
s$pfx_var <- rep(v, nrow(s))
s$mlbam_id <- rep(i, nrow(s))
s
View(index_year)
index_year <- pitchers %>%
filter(key_mlbam == paste(i)) %>%
select(index_year)
s <- data(i,v) %>%
filter(Year == paste(index_year) |
Year == paste(index_year-1) |
Year == paste(index_year-2)) %>%
gather(pitchType, speed, -Year) %>%
rename(year = Year)
s$pfx_var <- rep(v, nrow(s))
s$mlbam_id <- rep(i, nrow(s))
s
library(tidyr)
library(dplyr)
library(magrittr)
pitchers <- tbl_df(read.csv("tjs_pitchers.csv"))
pitchers.keys <- c(592238, 595032, 458537)
# pitchers.keys <- pitchers$key_mlbam
# var_list <- c("mph", "maxmph", "pfx_x", "pfx_z", "hloc", "vloc", "bway")
var_list <- c("mph")
pitchfx <- data.frame()
# for each pitcher
for (i in length(pitchers.keys)) {
# for each pitchf/x variable
for (v in length(var_list)) {
# TODO: move script into loop
# data table is returned as a list
# TODO: insert pitchers.keys[i] and var_list[v] into url
data <- function(i,v) {
url <- paste0("http://www.brooksbaseball.net/velo.php?player=",i,"&b_hand=-1&gFilt=&pFilt=FA|SI|FC|CU|SL|CS|KN|CH|FS|SB&time=year&minmax=ci&var=",v,"&s_type=2&startDate=01/01/2008&endDate=12/31/2014")
d <- readHTMLTable(url, header = TRUE, skip.rows = 1, as.data.frame = TRUE, stringsAsFactors = FALSE)
d <- d[[1]]
d <- d[complete.cases(d),]
d
}
stats <- function(i,v) {
index_year <- pitchers %>%
filter(key_mlbam == paste(i)) %>%
select(index_year)
s <- data(i,v) %>%
filter(Year == paste(index_year) |
Year == paste(index_year-1) |
Year == paste(index_year-2)) %>%
gather(pitchType, speed, -Year) %>%
rename(year = Year)
s$pfx_var <- rep(v, nrow(s))
s$mlbam_id <- rep(i, nrow(s))
s
}
pitchfx <- stats(i,v) %>%
rbind(pitchfx)
}
}
for i in length(pitchers.keys) {
